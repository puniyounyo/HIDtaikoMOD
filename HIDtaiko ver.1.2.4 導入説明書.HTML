<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HIDtaiko ver.1.2.4 導入説明書</title>
    <style>
        body {
            font-family: sans-serif;
            line-height: 1.6;
            margin: 20px;
        }
        h1, h2, h3 {
            color: #333;
        }
        h1 {
            border-bottom: 2px solid #ccc;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        h2 {
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        h3 {
            margin-top: 20px;
            margin-bottom: 10px;
        }
        ul, ol {
            margin-bottom: 15px;
        }
        li {
            margin-bottom: 5px;
        }
        a {
            color: #007bff;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .section {
            margin-bottom: 30px;
        }
        .note {
            background-color: #f8f9fa;
            border: 1px solid #eee;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>HIDtaiko ver.1.2.4 導入説明書</h1>

    <div class="section">
        <h2>はじめに</h2>
        <p>この説明書では、自作の太鼓型入力デバイス「HIDtaiko」を制御するためのArduinoスケッチ「HIDtaiko ver.1.2.4」をArduino IDEに導入し、動作させるまでの手順を解説します。</p>
    </div>

    <div class="section">
        <h2>必要なもの</h2>
        <ul>
            <li><strong>Arduinoボード:</strong> スケッチに対応したArduinoボード（例：Arduino Uno、Arduino Leonardoなど）。特に、<code>Keyboard.h</code>ライブラリを使用する場合は、ATmega32U4チップを搭載したボード（Leonardo、Microなど）を推奨します。Nintendo Switch制御機能を使用する場合は、それに対応したボードやライブラリの要件を確認してください。</li>
            <li><strong>Arduino IDE (Integrated Development Environment):</strong> Arduinoボードにスケッチを書き込むためのソフトウェア。最新版を<a href="https://www.arduino.cc/en/software" target="_blank">Arduino公式サイト</a>からダウンロードし、インストールしてください。</li>
            <li><strong>USBケーブル:</strong> ArduinoボードとPCを接続するためのUSBケーブル。</li>
            <li><strong>関連ライブラリ:</strong> スケッチで使用している以下のライブラリをArduino IDEにインストールする必要があります。
                <ul>
                    <li><code>Adafruit_GFX_Library</code></li>
                    <li><code>Adafruit_SSD1306</code></li>
                    <li><code>EEPROM</code> (Arduino IDEに標準で含まれている場合があります)</li>
                    <li><code>NintendoSwitchControlLibrary</code> (Nintendo Switch制御機能を使用する場合)</li>
                </ul>
            </li>
            <li><strong>HIDtaikoハードウェア:</strong> 作成済みの太鼓型入力デバイス（センサー、ボタン、OLEDディスプレイなどがArduinoボードに適切に配線されている必要があります）。</li>
        </ul>
    </div>

    <div class="section">
        <h2>ライブラリのインストール手順</h2>
        <p>スケッチで使用しているライブラリをArduino IDEにインストールします。</p>
        <ol>
            <li><strong>Arduino IDEを起動します。</strong></li>
            <li><strong>「スケッチ」メニューから「ライブラリをインクルード」を選択し、「ライブラリを管理...」をクリックします。</strong></li>
            <li><strong>ライブラリマネージャの検索バーに、以下のライブラリ名を一つずつ入力して検索し、インストールします。</strong>
                <ul>
                    <li><code>Adafruit GFX Library</code> (Adafruit Industriesによるもの)</li>
                    <li><code>Adafruit SSD1306</code> (Adafruit Industriesによるもの)</li>
                    <li><code>EEPROM</code> (通常はインストール不要ですが、念のため検索して存在を確認してください)</li>
                    <li><code>NintendoSwitchControlLibrary</code> (Pro MicroなどのATmega32U4ベースのボードで使用する場合は、<a href="https://github.com/nicohood/NintendoSwitchControlLibrary" target="_blank">GitHubリポジトリ</a>からダウンロードして手動でインストールする必要がある場合があります。「スケッチ」メニューから「ライブラリをインクルード」→「.ZIP形式のライブラリを追加...」を選択し、ダウンロードしたZIPファイルを指定してください。)</li>
                </ul>
            </li>
            <li><strong>各ライブラリの最新バージョンが推奨されますが、特定のバージョンが必要な場合は、インストール時にバージョンを選択できます。</strong></li>
            <li><strong>すべての必要なライブラリのインストールが完了したら、ライブラリマネージャを閉じます。</strong></li>
        </ol>
    </div>

    <div class="section">
        <h2>スケッチの導入手順</h2>
        <ol>
            <li><strong>この導入説明書と共に提供されたArduinoスケッチのコード（通常は <code>.ino</code> ファイル）を、Arduino IDEの新しいウィンドウにコピー＆ペーストします。</strong></li>
            <li><strong>「ファイル」メニューから「名前を付けて保存...」を選択し、適切な場所にスケッチの名前（例：<code>HIDtaiko</code>）で保存します。</strong> Arduino IDEは、スケッチ名と同じ名前のフォルダを作成し、その中に <code>.ino</code> ファイルを保存します。</li>
        </ol>
    </div>

    <div class="section">
        <h2>ボードとポートの設定</h2>
        <p>Arduino IDEで、使用するArduinoボードとPCとの接続ポートを設定します。</p>
        <ol>
            <li><strong>ArduinoボードをUSBケーブルでPCに接続します。</strong></li>
            <li><strong>Arduino IDEの「ツール」メニューから「ボード」を選択し、使用しているArduinoボードのモデルを選択します。（例：「Arduino Uno」、「Arduino Leonardo」など）</strong></li>
            <li><strong>「ツール」メニューから「ポート」を選択し、接続されているArduinoボードのシリアルポートを選択します。</strong> ポート名は環境によって異なります。（例：Windowsの場合は「COMx」、macOS/Linuxの場合は「/dev/tty.usbmodemxxxx」など）</li>
        </ol>
    </div>

    <div class="section">
        <h2>スケッチの書き込み</h2>
        <p>設定が完了したら、スケッチをArduinoボードに書き込みます。</p>
        <ol>
            <li><strong>Arduino IDEのツールバーにある右向きの矢印ボタン（「マイコンボードに書き込む」）をクリックします。</strong></li>
            <li><strong>Arduino IDEの下部のステータスバーに、書き込みの進捗状況が表示されます。</strong></li>
            <li><strong>書き込みが完了すると、「マイコンボードへの書き込みが完了しました。」というメッセージが表示されます。</strong></li>
        </ol>
    </div>

    <div class="section">
        <h2>動作確認</h2>
        <ol>
            <li><strong>シリアルモニタの起動:</strong> Arduino IDEの「ツール」メニューから「シリアルモニタ」を選択します。（または、ツールバーの右端にある虫眼鏡アイコンをクリックします）</li>
            <li><strong>ボーレートの設定:</strong> シリアルモニタの右下にあるドロップダウンメニューで、スケッチ内の <code>Serial.begin()</code> で設定したボーレート（通常は <code>115200</code>）と同じ値を選択します。</li>
            <li><strong>起動メッセージの確認:</strong> Arduinoボードのリセットボタンを押すか、USBケーブルを抜き差しして再接続すると、シリアルモニタに起動メッセージ（「Starting...」、「PCモードを有効化します。」または「Switchモードを有効化します。」など）が表示されることを確認します。</li>
            <li><strong>モードの確認:</strong> OLEDディスプレイが搭載されている場合は、ディスプレイに現在の動作モード（PC MODEまたはSW MODE）が表示されることを確認します。</li>
            <li><strong>入力のテスト:</strong>
                <ul>
                    <li><strong>PCモード:</strong> HIDtaikoの各入力（太鼓面、ボタンなど）を操作し、シリアルモニタに反応が表示されるか、PC上でキーボード入力がエミュレートされているかを確認します。</li>
                    <li><strong>Nintendo Switchモード:</strong> HIDtaikoの各入力を操作し、Nintendo Switch上で対応する操作が行われるか確認します。</li>
                </ul>
            </li>
            <li><strong>設定モードのテスト:</strong> PCモード時に、設定モード切り替えボタン（14番ピンに接続されたボタン）を押して、OLEDディスプレイが設定モード表示に切り替わることを確認します。数値増減ボタン（6, 7番ピン）と決定ボタン（8番ピン）を使用して、設定値を変更できること、および最終項目で決定ボタンを押すと通常モードに戻ることを確認します。</li>
            <li><strong>EEPROM保存の確認:</strong> 設定モードで値を変更した後、Arduinoボードを再起動し、シリアルモニタまたはOLEDディスプレイで、変更した設定値が保持されているか確認します。</li>
        </ol>
    </div>

    <div class="section">
        <h2>トラブルシューティング</h2>
        <ul>
            <li><strong>コンパイルエラー:</strong> Arduino IDEにエラーメッセージが表示される場合は、以下の点を確認してください。
                <ul>
                    <li>必要なライブラリがすべて正しくインストールされているか。</li>
                    <li>スケッチのコードにタイプミスがないか。</li>
                    <li>使用しているArduinoボードがスケッチの機能（特に <code>Keyboard.h</code> や <code>NintendoSwitchControlLibrary</code>）に対応しているか。</li>
                </ul>
            </li>
            <li><strong>書き込みエラー:</strong> スケッチをArduinoボードに書き込めない場合は、以下の点を確認してください。
                <ul>
                    <li>ArduinoボードがUSBケーブルで正しくPCに接続されているか。</li>
                    <li>Arduino IDEで正しいボードとポートが選択されているか。</li>
                    <li>USBドライバが正しくインストールされているか（必要に応じて再インストールを試してください）。</li>
                </ul>
            </li>
            <li><strong>動作しない:</strong> 書き込みは成功したが、HIDtaikoが意図通りに動作しない場合は、以下の点を確認してください。
                <ul>
                    <li>ハードウェアの配線がスケッチのピン定義と一致しているか。</li>
                    <li>センサーやボタンなどの入力デバイスが正常に動作しているか。</li>
                    <li>シリアルモニタの出力を確認し、スケッチが意図した通りの入力を認識しているか。</li>
                    <li>Nintendo Switchモードの場合は、Switch本体の設定やペアリングが適切に行われているか。</li>
                </ul>
            </li>
        </ul>
    </div>

    <div class="section">
        <h2>その他</h2>
        <p>このスケッチはバージョン1.2.4です。将来的に新しいバージョンが公開される可能性があります。</p>
        <p>スケッチの詳細な機能や設定については、別途提供されている「HIDtaiko ver.1.2.4 スケッチ説明書」を参照してください。</p>
    </div>

</body>
</html>